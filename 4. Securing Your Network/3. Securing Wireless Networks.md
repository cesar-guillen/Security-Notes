Wireless networks have become important and have become more secure over the past few years. However, they still susceptible to misconfigurations allowing attackers to gain access.

## Reviewing Wireless Basics
A *Wireless Access Point (WAP)* connects wireless clients to a wire network. However, many WAPs also have routing capabilities. Clients can often connect with physical ports to the WAN or use the Wireless access. 

##### Access Point SSID
Wireless networks are identified by a *service set identifier (SSID)*, which is simply the wireless network name. Some APs still come with default SSIDS, though most vendors have moved away from this practice and now force clients to change the name (WiFi router name).

##### [[3. Basic Network Infrastructure#Hardening Switches|MAC Filtering]]
Every NIC, including wireless NICs, has a MAC address. Most wireless routers allow you to specify what MAC addresses to allow, and they will block all others, or you can specify what MAC addresses to block, and they will allow all others. 

This might sound secure, but an attacker can easily bypass MAC filtering. Using a wireless sniffer, an attacker can identify MAC addresses allowed in a wireless network. Once he knows what MAC addresses are allowed, he can change his system’s MAC address to **impersonate** one of the allowed MAC addresses.

##### MAC Address Cloning
*MAC address cloning* refers to changing the MAC address on a PC or other device with the same MAC address as the wide area network (WAN) port on an Internet-facing router. MAC address cloning sometimes resolves connectivity issues on small home or office networks. In a MAC cloning attack (sometimes called a MAC spoofing attack), an attacker changes his computer’s MAC address to the MAC address of an authorized system. This will bypass MAC filtering.

## Site Surveys and Heat Maps
The *site survey* examines the wireless environment to identify potential issues, such as areas with noise or other devices operating on the same frequency bands. This is done periodically to make sure the environment has not changed.

One method to perform a site survey is by using a *Wi-Fi analyzer*. These analyzers identify and analyze activity on channels within the wireless spectrum. Other site survey tools will create a *heat map*, which will give a color-coded representation of wireless signals. 

*Wireless footprinting* creates a detailed diagram of APs and hotspots within an organization. By overlaying the heat map onto a basic architectural drawing of an organization’s spaces, it’s possible to see the location of the APs along with dead spots and hotspots.

> [!REMEMBER]
> A site survey examines the wireless environment to identify potential problem areas. A heat map shows wireless coverage and dead spots if they exist. Wireless footprinting gives you a detailed diagram of wireless access points, hotspots, and dead spots within an organization.

## Wireless Cryptographic Protocols
In the old days security was an afterthought and as long as an attacker had a receiver communications could be sniffed. Old cryptographic solutions like *WEP* and *WPA* were quickly exploited and are not secure.

##### WPA2 and CCMP
The WiFi Alliance developed *WiFi Protected Access 2 (WPA2)* to replace the earlier mentioned protocols. WPA2 (also known as IEEE 802.11i) uses strong cryptographic protocols such as **AES and Counter-Model/CBC-MAC Protocol (CCMP)** ^700414

##### Open, PSK and Enterprise Modes
WPA2 can operate in open, *pre-shared key (PSK)*, or *Enterprise* modes. *Open mode* does **not use any security**. Instead, all data is transferred in **cleartext**.

When Using *PSK mode*, users access the wireless network anonymously with a PSK or passphrase. This does not provide [[1. Comparing Identifications and AAA#^a1a5ff|authentication]].  This is basically how most home networks work. 

Enterprise mode force users to authenticate with unique credentials before granting access to the wireless network.  This is often implemented with a **RADIUS** server which handles authentication which will later communicate with the WAP to grant or deny access. 

* **RADIUS server**. You enter the IP address assigned to the 802.1X server, which is often a RADIUS server. 
* **RADIUS port**. You enter the port used by the RADIUS server. The official default port for RADIUS is 1812. However, some vendors have used other ports, such as 1645. The key is that you must enter the same port here that the server is using. 
* **Shared secret**. The shared secret is similar to a password, and you must enter it here exactly as it is entered on the RADIUS server. This is different than the user’s password.

##### WPA3 and Simultaneous Authentication of Equals
*WiFi Protected Access 3 (WPA3)* devices are now widely available on many enterprise wireless networks. WPA3 supports three modes of operations:

1. **Enhanced Open Mode**: Replaces the insecure, unencrypted, open mode of WPA2 with strong encryption which allows you to run a secure guest network. 
2. **Simultaneous Authentication of Equals (SAE) Mode**: Replaces the PSK mode of WPA2. Uses a passphrase but uses strong security defenses. ^0aaff5
3. **Enterprise Mode**: Also supported in WPA3 using a **RADIUS** server and individual user authentication.

## Authentication Protocols
Many are built on the *Extensible Authentication Protocol (EAP)*. A key point to remember for each of these methods is if they support or require certificates:

* **EAP**: Provides a method for two systems to create a secure encryption key also known as the *Pairwise Master Key (PMK)*. Systems then encrypt traffic between the devices. 
* **Protected EAP (PEAP)**: Provides an extra layer of protection for EAP. PEAP protects the communication channel by encapsulating and encrypting the EAP conversation in a *TLS tunnel*.  PEAP requires a certificate for the server but not for the clients. 
* **EAP-FAST**: A secure replacement for *Lightweight EAP (LEAP)*. EAP-FAST supports PAC (Protected Access Credential) instead of certificates.
* **EAP-TLS**: Same as *PEAP* but requires the certificate for the clients as well. Most secure.
* **EAP-TTLS**: EAP-Tunneled TLS is an extension of *EAP-TLS*, allows systems to use some older authentication methods within a TLS tunnel. Does not require certs for clients.
* **RADIUS Federation**: Creates a [[5. Comparing Authentication Services#SSO and a Federation|federation]] using RADIUS servers

## IEEE 802.1X Security
Another method of port security is to use *IEEE 802.1X*, a port-based authentication protocol. It requires users or devices to authenticate when they connect to a specific wireless access point or a specific physical port. Administrators implement it in both wireless and wired networks, and can also use it with [[5. Using VPNs for Remote Access|virtual private networks (VPNs)]]

802.1X secures the authentication process prior to a client gaining access to a network and blocks network access if the client cannot authenticate. 802.1X can use simple usernames and passwords for authentication, or certificates for certificate-based authentication.

> [!REMEMBER]
> Enterprise mode requires an 802.1X server. EAP-FAST supports PACs. PEAP and EAP-TTLS require a certificate on the 802.1X server. EAP-TLS also uses TLS, but it requires certificates on both the 802.1X server and each of the clients. An 802.1X server provides port-based authentication, ensuring that only authorized clients can connect to a device or a network. It prevents rogue devices from connecting.

## Captive Portals
A captive portal is a technical solution that forces clients using web browsers to complete a specific process before it allows them access to the network. Organizations commonly use it as a hotspot that requires users to log on or agree to specific terms before they can access the Internet.

* Free Internet Access
* Paid Internet Access
* Alternative to IEEE 802.1X